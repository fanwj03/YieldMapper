# YieldMapper 股息率管理工具

一个基于 Flask + akshare 的股息率管理 Web 工具，支持 A 股和港股，自动抓取分红数据，帮助投资者快速计算目标买入价格。

## 功能特性

- **自动获取分红数据**：通过 akshare 自动抓取 A 股和港股近一年合计每股分红
- **手动修改分红**：支持手动覆盖自动获取的分红数据
- **目标价格计算**：自动计算 3%、3.5%、4%、5%、6% 股息率对应的目标买入价
- **实时股息率**：输入任意价格，即时计算对应股息率
- **港股汇率换算**：港股分红自动换算为人民币
- **分红日期预测**：显示最近两次历史分红日，并预测下一次分红时间
- **本地搜索过滤**：已添加的股票支持按名称/代码本地过滤，无需联网
- **固定表头与列**：横向滚动时序号和股票名称列固定，纵向滚动时表头固定

## 界面预览

| 功能 | 说明 |
|------|------|
| 添加股票 | 输入名称或代码，选择市场，自动获取数据 |
| 股息率表格 | 显示当前价、分红、各目标价、预计下次分红日 |
| 本地搜索 | 从已添加列表中快速查找 |
| 手动编辑 | 点击编辑按钮可修改分红金额 |

## 环境要求

- Python 3.8+
- pip

## 安装与运行

```bash
# 1. 克隆仓库
git clone https://github.com/fanwj03/YieldMapper.git
cd YieldMapper

# 2. 安装依赖
pip install -r requirements.txt

# 3. 启动服务
python app.py
```

浏览器打开 [http://localhost:5000](http://localhost:5000) 即可使用。

## 依赖说明

| 包 | 用途 |
|----|------|
| Flask | Web 后端框架 |
| akshare | A股/港股数据源（分红、价格、汇率） |
| pandas | 数据处理 |

## 数据说明

- 股票数据保存在本地 `data.json`（已加入 `.gitignore`，不上传）
- A 股列表缓存保存在 `cache_a_stocks.json`，有效期 24 小时
- 港股列表缓存保存在 `cache_hk_stocks.json`，有效期 24 小时
- **首次搜索 A 股名称**时需抓取全市场列表，约需 1 分钟；后续使用缓存，极快

## 目录结构

```
YieldMapper/
├── app.py            # Flask 后端（API + 数据逻辑）
├── index.html        # 单页前端
├── requirements.txt  # Python 依赖
├── .gitignore        # 忽略本地数据文件
└── README.md         # 说明文档
```

## API 接口

| 方法 | 路径 | 说明 |
|------|------|------|
| GET | `/` | 前端页面 |
| GET | `/api/hkd_rate` | 获取港元/人民币汇率 |
| POST | `/api/search` | 搜索股票并获取分红 |
| GET | `/api/stocks` | 获取已保存的所有股票 |
| POST | `/api/stocks` | 添加股票 |
| PUT | `/api/stocks/<id>` | 更新股票信息 |
| DELETE | `/api/stocks/<id>` | 删除股票 |

## 注意事项

- 分红数据来源为公开行情，仅供参考，不构成投资建议
- 港股分红金额从公告文本中解析，极少数格式特殊的公告可能解析失败，此时可手动填写
- 汇率数据来源为东方财富/中国银行，网络异常时使用默认值 0.924
